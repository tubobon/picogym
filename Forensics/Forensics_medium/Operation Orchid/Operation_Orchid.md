# Operation Orchid
## 解法
ディスクイメージなので安定的にfileコマンドとfsstatコマンドでファイルシステムの存在を検証。\
結果、ファイルシステムが存在しないことがわかった。\
しかし、`mmls`コマンドでパーティションテーブルがあることがわかった。\
ここで重要なのはfsstatコマンドはファイルの先頭からファイルシステムの存在を検出するものであり、offsetがかかっている場合、うまく検出できないのである。\
つまりこのoffsetをうまく指定してやれば、`fsstat`も`fls+icat`も`blkls`もつかえるって魂胆だ\
指定は簡単で、`fsstat -o ブロック数 disk.img`で可能（ほかのコマンドもこんな感じ）\
最近`mount`が面倒になってきて、大体同じことができてさらに削除ファイルまで見れる`fls+icat`コマンドのほうがいいやと思ってそっちを今後使っていくことにした。\
※とはいってもgrepなどの全探索は`mount`のほうが確実に向いているため、必要になったら使う\
`fls+icat`コマンド（offsetは指定済み）を実行すると`flag.txt`,`flag.txt.enc`というものを見つけた。\
`flag.txt`はinodeが再利用されていて中身が壊れていた。\
`flag.txt.enc`には暗号化されたflagが入っていた。\
`flag.txt`はどうしようもないので、`flag.txt.enc`をどうにかしようと思っていた矢先、`fls`で見たこの二つの項目の上に`.ash_history`を発見\
中身はこの暗号文を暗号化した際のパスワードと暗号化方式の記録が書かれていた。\
そして`openssl`コマンドで`.ash_history`をみながら、復号コマンドを作成、実行しflagを得た